<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Transcriptions</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script src="amcharts/amcharts.js" type="text/javascript"></script>
    <script src="amcharts/serial.js" type="text/javascript"></script>
    <script src="amcharts/plugins/dataloader/dataloader.js" type="text/javascript"></script>
    <script src="amcharts/plugins/responsive/responsive.js" type="text/javascript"></script>
    <script>
        AmCharts.makeChart("chartdiv", {
            type: "serial",
            fontSize: 12,
            marginTop: 10,
            categoryField: 'hour',
            categoryAxis: {
                gridAlpha: 0.07,
                axisColor: "#DADADA",
                startOnAxis: true
            },
            chartCursor: {
                cursorAlpha: 0
            },
            responsive: {enabled: true},
            svgIcons: false,
            chartScrollbar: {
                color: "FFFFFF",
                dragIcon: "dragIconRoundSmall.png"
            },
            valueAxes: [{
                stackType: "regular",
                gridAlpha: 0.07,
                title: "Number of Transcriptions"
            }],
            "dataLoader": {
                "url": "wedigbio.csv",
                "format": "csv",
                "showErrors": true,
                "postProcess": function (data, config, chart) {
                    var graphs = []
                      , chartData = []
                      , current_hour;

                    for (var i=0; i < data.length; i++){
                        var item = data[i]
                          , collection = item.col0
                          , count = item.col1
                          , hour = item.col2
                          , obj;

                        if (current_hour != hour) {
                            if (obj) chartData.push(obj);
                            obj = {}; //probably not necessary
                            current_hour = hour;
                            obj["hour"] = hour;
                        }
                            obj[collection] = count;
                    }

                    for (col in chartData[0]){
                        if (col != "hour"){
                            graphs.push({
                                type: "line",
                                title: col,
                                lineAlpha: 0,
                                valueField: col,
                                fillAlphas: 0.6,
                                baloonText: "<span>[[col]]</span><span style='font-size:14px; color:#000000;'><b>[[collection]][[total]]</b></span>"
                            })
                        }
                    }

                    chart.graphs = graphs;
                    return chartData;
                }
            },
            legend: {
                position: "bottom",
                labelText: "[[title]]",
                valueText: "Total: [[value]]",
                valueWidth: 100,
                valueAlign: "left",
                equalWidths: false,
                periodValueText: "Total: [[value.high]]",

            }
        });

    </script>
</head>

<body>
<div id="chartdiv" style="width:100%; height:400px;"></div>
</body>

</html>
